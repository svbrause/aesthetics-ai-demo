"use strict";exports.id=131,exports.ids=[131],exports.modules={5131:(e,o,i)=>{i.d(o,{e:()=>d});class n{constructor(){this.baseURL="https://ponce--my-training-app-predict-endpoint.modal.run"}async analyzeWithBase64(e,o,i=.5){try{console.log("Attempting Modal API call with base64 data...");let n=e.split(",")[1],s=o.split(",")[1],a=await fetch(this.baseURL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({front_b64:n,side_b64:s,threshold:i})});if(!a.ok){let e=await a.text();throw console.log("Base64 approach failed, trying file path approach:",e),Error(`Modal API failed: ${a.status} - ${e}`)}let r=await a.json();return console.log("Modal API base64 result:",r),r}catch(e){throw console.log("Base64 approach failed, trying file path approach:",e),e}}async analyzeWithPaths(e,o,i=.5){try{console.log("Attempting Modal API call with file paths..."),console.log("Front path:",e),console.log("Side path:",o);let n=`${this.baseURL}?front_path=${encodeURIComponent(e)}&side_path=${encodeURIComponent(o)}&threshold=${i}`,s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"}});if(console.log("Modal API response status:",s.status),!s.ok){let e=await s.text();throw Error(`Modal API failed: ${s.status} - ${e}`)}let a=await s.json();return console.log("Modal API file path result:",a),a}catch(e){throw console.error("File path approach failed:",e),e}}generateMockResponse(e,o){console.log("Generating mock response for demo purposes...");let i=["Nasolabial Folds","Under Eye Hollow","Dark Spots","Crow's Feet Wrinkles","Marionette Lines","Jowls","Neck Lines","Temporal Hollow","Prejowl Sulcus","Forehead Wrinkles"],n={},s=[];return i.forEach((e,o)=>{let i=.4*Math.random()+.3;n[e]=i,i>.5&&s.push([e,i])}),s.sort((e,o)=>o[1]-e[1]),{success:!0,predictions:i.slice(0,5),probabilities:n,top_predictions:s.slice(0,5),threshold:.5,total_labels:81,front_path:`uploaded_${e.name}`,side_path:`uploaded_${o.name}`,timestamp:Math.floor(Date.now()/1e3)}}}let s=new n,a={"Forehead Wrinkles":"Skin","Crow's Feet Wrinkles":"Skin","Glabella Wrinkles":"Skin","Under Eye Wrinkles":"Skin","Perioral Wrinkles":"Skin","Bunny Lines":"Skin","Neck Lines":"Skin","Dark Spots":"Skin","Red Spots":"Skin",Scars:"Skin","Dry Skin":"Skin",Whiteheads:"Skin",Blackheads:"Skin","Under Eye Dark Circles":"Eyes","Crepey Skin":"Skin","Rosacea [DEPRECATED]":"Skin","Nasolabial Folds":"Skin","Marionette Lines":"Skin","Temporal Hollow":"Forehead","Brow Asymmetry":"Forehead","Flat Forehead":"Forehead","Brow Ptosis":"Forehead","Excess Upper Eyelid Skin":"Eyes","Lower Eyelid - Excess Skin":"Eyes","Upper Eyelid Droop":"Eyes","Lower Eyelid Sag":"Eyes","Lower Eyelid Bags":"Eyes","Under Eye Hollow":"Eyes","Upper Eye Hollow":"Eyes","Mid Cheek Flattening":"Cheeks","Cheekbone - Not Prominent":"Cheeks","Heavy Lateral Cheek":"Cheeks","Crooked Nose":"Nose","Droopy Tip":"Nose","Dorsal Hump":"Nose","Tip Droop When Smiling":"Nose","Thin Lips":"Lips","Lacking Philtral Column":"Lips","Long Philtral Column":"Lips","Gummy Smile":"Lips","Asymmetric Lips":"Lips","Dry Lips":"Lips","Lip Thinning When Smiling":"Lips","Retruded Chin":"Jawline","Over-Projected Chin":"Jawline","Asymmetric Chin":"Jawline",Jowls:"Jawline","Lower Cheeks - Volume Depletion":"Jawline","Ill-Defined Jawline":"Jawline","Asymmetric Jawline":"Jawline","Masseter Hypertrophy":"Jawline","Prejowl Sulcus":"Jawline","Loose Neck Skin":"Jawline","Platysmal Bands":"Jawline","Excess/Submental Fullness":"Jawline","Over-Projected":"Nose","Over-Rotated":"Nose","Under-Projected":"Nose","Under-Rotated":"Nose","Nasal Bone - Too Wide":"Nose","Nasal Tip Too Wide":"Nose","Nasal Tip Too Narrow":"Nose","Nostril Base - Too Wide":"Nose","Negative Canthal Tilt":"Eyes","Wide Chin":"Jawline","Wide Jawline":"Jawline","Narrow Jawline":"Jawline",Oily:"Skin","Acne [DEPRECATED]":"Skin","Alar Hang [DEPRECATED]":"Nose","Alar Retraction [DEPRECATED]":"Nose","Asymmetric Nostril Base [DEPRECATED]":"Nose","Cheilosis [DEPRECATED]":"Lips","Columellar Hang [DEPRECATED]":"Nose","Columellar Retraction [DEPRECATED]":"Nose","Deep Labiomental Groove [DEPRECATED]":"Lips","Deep Radix [DEPRECATED]":"Nose","Shallow Labiomental Groove [DEPRECATED]":"Lips","Shallow Radix [DEPRECATED]":"Nose","Obtuse Cervicomental Angle [DEPRECATED]":"Jawline"};function r(e){return a[e]||"Other"}function t(e){return Math.round(95-35*Math.max(0,Math.min(1,e)))}function l(e){return e>=90?"A":e>=80?"B":e>=70?"C":e>=60?"D":"F"}let c=process.env.NEXT_PUBLIC_MODAL_API_URL||"https://ponce--my-training-app-predict-endpoint.modal.run";async function d(e,o){try{console.log("Starting photo analysis..."),console.log("Modal API URL:",c);let i=await p(e),n=await p(o);console.log("Calling Modal API...");try{console.log("Attempting Modal API with base64 data...");let e=await s.analyzeWithBase64(i,n,.5);return console.log("Modal API base64 result:",e),{analysis:h(e),rawResponse:e}}catch(i){console.log("Base64 approach failed, trying file path approach:",i);try{console.log("Attempting to upload images to Modal volume...");let e={front_path:"training_images/0_front.jpg",side_path:"training_images/0_side.jpg"};console.log("Using training image paths:",e);let o=await s.analyzeWithPaths(e.front_path,e.side_path,.5);return console.log("Modal API file path result:",o),{analysis:h(o),rawResponse:o}}catch(n){console.log("File path approach failed, using mock response:",n);let i=s.generateMockResponse(e,o);return await new Promise(e=>setTimeout(e,2e3)),console.log("Using mock Modal API result:",i),{analysis:h(i),rawResponse:i}}}}catch(e){return console.error("Modal analysis error:",e),console.log("Falling back to mock analysis for demo purposes"),{analysis:{issues:[{name:"Nasolabial Folds",severity:"moderate",confidence:78,description:"Lines running from nose to mouth corners",area:"facial-structure"},{name:"Under Eye Hollow",severity:"severe",confidence:85,description:"Volume loss creating shadows under the eyes",area:"facial-structure"},{name:"Dark Spots",severity:"mild",confidence:65,description:"Hyperpigmentation and age spots visible on the skin",area:"skin-quality"}],overallScore:76,recommendations:["Consider dermal fillers for volume restoration","Professional skincare routine recommended","Botox may help with muscle-related concerns"],areas:{"facial-structure":[{name:"Nasolabial Folds",severity:"moderate",confidence:78,description:"Lines running from nose to mouth corners",area:"facial-structure"},{name:"Under Eye Hollow",severity:"severe",confidence:85,description:"Volume loss creating shadows under the eyes",area:"facial-structure"}],"skin-quality":[{name:"Dark Spots",severity:"mild",confidence:65,description:"Hyperpigmentation and age spots visible on the skin",area:"skin-quality"}]}},error:e instanceof Error?e.message:String(e)}}}function p(e){return new Promise((o,i)=>{let n=new FileReader;n.readAsDataURL(e),n.onload=()=>o(n.result),n.onerror=e=>i(e)})}function h(e){let o=[],i={};console.log("Processing Modal API response:",e),e.success&&e.top_predictions&&Array.isArray(e.top_predictions)?e.top_predictions.forEach(([e,n])=>{let s=u(n),a=r(e),c=t(n),d=l(c),p={name:e,severity:s,confidence:c,description:m(e),area:a,gradeLetter:d};o.push(p),i[a]||(i[a]=[]),i[a].push(p)}):e.success&&e.probabilities&&"object"==typeof e.probabilities?Object.entries(e.probabilities).forEach(([e,n])=>{if(n>.3){let s=u(n),a=r(e),c=t(n),d=l(c),p={name:e,severity:s,confidence:c,description:m(e),area:a,gradeLetter:d};o.push(p),i[a]||(i[a]=[]),i[a].push(p)}}):e.error?console.error("Modal API returned error:",e.error):console.warn("Unexpected Modal API response format:",e);let n=o.length>0?Math.round(o.reduce((e,o)=>e+o.confidence,0)/o.length):95;return{issues:o,overallScore:n,recommendations:function(e){let o=[],i=e.filter(e=>"facial-structure"===e.area),n=e.filter(e=>"skin-quality"===e.area);return i.length>0&&(o.push("Consider dermal fillers for volume restoration"),o.push("Botox may help with muscle-related concerns")),n.length>0&&(o.push("Professional skincare routine recommended"),o.push("Consider laser treatments for pigmentation")),e.some(e=>e.name.includes("Nasal"))&&o.push("Rhinoplasty consultation may be beneficial"),o}(o),areas:i}}function u(e){return e<.4?"mild":e<.7?"moderate":"severe"}function m(e){return({"Dark Spots":"Hyperpigmentation and age spots visible on the skin","Dry Lips":"Dehydrated and chapped lips","Forehead Wrinkles":"Horizontal lines across the forehead","Crow's Feet Wrinkles":"Fine lines around the eyes","Under Eye Wrinkles":"Fine lines under the eyes",Blackheads:"Clogged pores with oxidized sebum",Whiteheads:"Closed comedones with trapped sebum","Red Spots":"Inflammatory skin lesions or acne marks",Scars:"Visible scarring from previous injuries or acne","Crepey Skin":"Thin, wrinkled skin with crepe-like texture","Dry Skin":"Dehydrated skin lacking moisture",Oily:"Excessive sebum production","Under Eye Dark Circles":"Dark discoloration under the eyes","Perioral Wrinkles":"Fine lines around the mouth area","Bunny Lines":"Horizontal lines across the nose bridge","Glabella Wrinkles":"Vertical lines between the eyebrows","Nasolabial Folds":"Lines running from nose to mouth corners","Under Eye Hollow":"Volume loss creating shadows under the eyes","Temporal Hollow":"Volume loss in the temple area","Prejowl Sulcus":"Depression before the jowl area","Masseter Hypertrophy":"Overdeveloped jaw muscles creating square appearance","Dorsal Hump":"Bump on the nasal bridge","Nasal Bone - Too Wide":"Wide nasal bone structure","Nasal Tip Too Wide":"Wide nasal tip","Nasal Tip Too Narrow":"Narrow nasal tip","Over-Projected":"Nose projects too far from the face","Under-Projected":"Nose projects too little from the face","Over-Rotated":"Nose tip rotated too far upward","Under-Rotated":"Nose tip rotated too far downward","Asymmetric Chin":"Chin asymmetry affecting facial balance","Asymmetric Lips":"Lip asymmetry affecting facial harmony","Asymmetric Jawline":"Jawline asymmetry affecting facial symmetry","Neck Lines":"Horizontal lines across the neck","Marionette Lines":"Lines from mouth corners downward",Jowls:"Sagging skin along the jawline","Excess/Submental Fullness":"Excess fat under the chin","Retruded Chin":"Recessed chin affecting profile","Over-Projected Chin":"Chin projects too far forward","Thin Lips":"Insufficient lip volume","Brow Asymmetry":"Uneven brow positioning","Brow Ptosis":"Drooping eyebrows","Lower Eyelid Sag":"Drooping lower eyelid skin","Lower Eyelid Bags":"Puffiness or bags under the eyes","Lower Eyelid - Excess Skin":"Excess skin in the lower eyelid area","Mid Cheek Flattening":"Loss of cheek volume and definition","Cheekbone - Not Prominent":"Lack of cheekbone definition","Heavy Lateral Cheek":"Excessive fullness in the lateral cheek area","Lower Cheeks - Over-Filled":"Excessive volume in the lower cheek area","Lower Cheeks - Volume Depletion":"Loss of volume in the lower cheek area","Ill-Defined Jawline":"Lack of clear jawline definition","Narrow Jawline":"Narrow jawline structure","Wide Jawline":"Wide jawline structure","Wide Chin":"Wide chin structure","Crooked Nose":"Nose deviation from centerline","Droopy Tip":"Nose tip pointing downward","Tip Droop When Smiling":"Nose tip droops when smiling","Nostril Base - Too Wide":"Wide nostril base","Negative Canthal Tilt":"Downward slant of the eye corners","Flat Forehead":"Lack of forehead projection","Excess Upper Eyelid Skin":"Excess skin in the upper eyelid area","Upper Eyelid Droop":"Drooping upper eyelid","Upper Eye Hollow":"Volume loss in the upper eye area","Loose Neck Skin":"Sagging skin in the neck area","Platysmal Bands":"Vertical bands in the neck muscles","Lacking Philtral Column":"Shallow philtrum (space between nose and lips)","Long Philtral Column":"Long philtrum (space between nose and lips)","Lip Thinning When Smiling":"Lips appear thinner when smiling","Gummy Smile":"Excessive gum exposure when smiling"})[e]||"Aesthetic concern requiring attention"}}};