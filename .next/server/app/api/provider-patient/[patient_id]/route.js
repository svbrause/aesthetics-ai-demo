"use strict";(()=>{var e={};e.id=527,e.ids=[527],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3799:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>f,patchFetch:()=>k,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>D});var n={};r.r(n),r.d(n,{GET:()=>l,dynamic:()=>d});var a=r(884),i=r(6132),s=r(1040),o=r(5798),u=r(8667);let d="force-dynamic";async function l(e,{params:t}){try{let r=t.patient_id,n=new URL(e.url),a=n.searchParams.get("providerCode"),i="true"===n.searchParams.get("debug");if(!a)return o.Z.json({error:"Provider code is required"},{status:400});i&&console.log("\uD83D\uDD0D DEBUG: Fetching patient:",r,"for provider:",a);let s=process.env.AIRTABLE_API_KEY,d=`https://api.airtable.com/v0/appXblSpAMBQskgzB/Patients?filterByFormula={Code (from Providers)}='${a}'`;i&&console.log("\uD83D\uDD0D DEBUG: Airtable URL:",d);let l=await fetch(d,{headers:{Authorization:`Bearer ${s}`}});if(i&&console.log("\uD83D\uDD0D DEBUG: Response status:",l.status),!l.ok){let e=await l.text();return i&&console.log("\uD83D\uDD0D DEBUG: Error response:",e),o.Z.json({error:`Airtable API error: ${l.status}`,details:e},{status:l.status})}let p=await l.json(),c=p.records;i&&console.log("\uD83D\uDD0D DEBUG: Found",c.length,"patients for provider");let g=c.find(e=>e.id===r);if(!g)return o.Z.json({error:"Patient not found in your patient list"},{status:404});let m=g.fields,h=m["Front Photo"]?.[0]?.url||null,D=m["Side Photo"]?.[0]?.url||null,f=m["Name (from All Issues) (from Analyses)"]||[],k=Array.isArray(f)?f.filter(e=>!e.includes("[DEPRECATED]")):[],y=m["Areas of Interest (from Form Submissions)"]||"",v=y?y.split(", ").map(e=>e.trim()):[],S=(0,u.Eu)(v),A=Math.max(60,100-2*k.length),E={id:g.id,name:m.Name||"Unknown Patient",age:m.Age||30,email:m.Email||"",phone:m.Phone||"",lastVisit:m["Last Visit"]||new Date().toISOString().split("T")[0],score:m.Score||A,findings:k,frontImage:h||"/Sydney Adams Front.png",sideImage:D||"/Sydney Adams Side.png",scanDate:m.Created?new Date(m.Created).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),airtableRecordId:g.id,provider:m.Provider||a,status:m.Status||"completed",reviewStatus:m["Review Status"]||"provider-only",areasOfInterest:S,"Issues String (from Patient-Issue/Suggestion Mapping) (from Interest Items)":m["Issues String (from Patient-Issue/Suggestion Mapping) (from Interest Items)"]||""},P={success:!0,patient:E};return i&&console.log("\uD83D\uDD0D DEBUG: Patient data:",JSON.stringify(P,null,2)),o.Z.json(P)}catch(e){return console.error("Error fetching provider patient:",e),o.Z.json({error:"Failed to fetch patient",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/provider-patient/[patient_id]/route",pathname:"/api/provider-patient/[patient_id]",filename:"route",bundlePath:"app/api/provider-patient/[patient_id]/route"},resolvedPagePath:"/Users/sambrause/Downloads/aesthetics-ai-demo REVERTED/src/app/api/provider-patient/[patient_id]/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:c,staticGenerationAsyncStorage:g,serverHooks:m,headerHooks:h,staticGenerationBailout:D}=p,f="/api/provider-patient/[patient_id]/route";function k(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:g})}},8667:(e,t,r)=>{r.d(t,{Eu:()=>a});let n={Eyebrows:"forehead",Eyes:"eyes",Cheeks:"cheeks",Nose:"nose",Lips:"lips","Face and Neck Aging":"skin","Jawline/chin":"jawline","Face and neck aging":"skin",Jawline:"jawline",Chin:"jawline",Neck:"jawline",Forehead:"forehead",Skin:"skin","Skin tone":"skin",Ears:"ears","Sides of face":"cheeks","Marionette lines":"skin","Acne scars on back and lower side of thighs":"skin","Face acne, scarring":"skin","Improve scars":"skin",Idk:"other","I'm not sure":"other",any:"other","While face":"other","Smile lines?":"skin","My cheeks are sagging, the older I get.":"cheeks"};function a(e){return Array.isArray(e)?e.map(e=>n[e]||"other"):[]}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[271,107],()=>r(3799));module.exports=n})();