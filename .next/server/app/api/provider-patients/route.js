"use strict";(()=>{var e={};e.id=362,e.ids=[362],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2811:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>m,originalPathname:()=>f,patchFetch:()=>k,requestAsyncStorage:()=>p,routeModule:()=>c,serverHooks:()=>h,staticGenerationAsyncStorage:()=>D,staticGenerationBailout:()=>g});var a={};t.r(a),t.d(a,{GET:()=>d,dynamic:()=>u});var s=t(884),n=t(6132),o=t(1040),i=t(5798),l=t(8667);let u="force-dynamic";async function d(e){try{let r=new URL(e.url),t=r.searchParams.get("providerId"),a="true"===r.searchParams.get("debug");if(!t)return i.Z.json({error:"Provider ID is required"},{status:400});a&&console.log("\uD83D\uDD0D DEBUG: Fetching patients for provider:",t);let s=process.env.AIRTABLE_API_KEY,n=`https://api.airtable.com/v0/appXblSpAMBQskgzB/Patients?filterByFormula={Code (from Providers)}='${t}'`;a&&console.log("\uD83D\uDD0D DEBUG: Airtable URL:",n);let o=await fetch(n,{headers:{Authorization:`Bearer ${s}`}});if(a&&console.log("\uD83D\uDD0D DEBUG: Response status:",o.status),!o.ok){let e=await o.text();return a&&console.log("\uD83D\uDD0D DEBUG: Error response:",e),i.Z.json({error:`Airtable API error: ${o.status}`,details:e},{status:o.status})}let u=await o.json(),d=u.records;a&&(console.log("\uD83D\uDD0D DEBUG: Raw Airtable response:",JSON.stringify(u,null,2)),console.log("\uD83D\uDD0D DEBUG: Number of records found:",d.length));let c=d.map(e=>{let r=e.fields,a=r["Front Photo"]?.[0]?.url||null,s=r["Side Photo"]?.[0]?.url||null,n=r["Name (from All Issues) (from Analyses)"]||[],o=Array.isArray(n)?n.filter(e=>!e.includes("[DEPRECATED]")):[],i=r["Areas of Interest (from Form Submissions)"]||"",u=i?i.split(", ").map(e=>e.trim()):[],d=(0,l.Eu)(u),c=Math.max(60,100-2*o.length);return{id:e.id,name:r.Name||"Unknown Patient",age:r.Age||30,email:r.Email||"",phone:r.Phone||"",lastVisit:r["Last Visit"]||new Date().toISOString().split("T")[0],score:r.Score||c,findings:o,frontImage:a||"/Sydney Adams Front.png",sideImage:s||"/Sydney Adams Side.png",scanDate:r.Created?new Date(r.Created).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),airtableRecordId:e.id,provider:r.Provider||t,status:r.Status||"completed",reviewStatus:r["Review Status"]||"provider-only",areasOfInterest:d}}),p={success:!0,patients:c};return a&&console.log("\uD83D\uDD0D DEBUG: Final response data:",JSON.stringify(p,null,2)),i.Z.json(p)}catch(e){return console.error("Error fetching provider patients:",e),i.Z.json({error:"Failed to fetch patients",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/provider-patients/route",pathname:"/api/provider-patients",filename:"route",bundlePath:"app/api/provider-patients/route"},resolvedPagePath:"/Users/sambrause/Downloads/aesthetics-ai-demo REVERTED/src/app/api/provider-patients/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:D,serverHooks:h,headerHooks:m,staticGenerationBailout:g}=c,f="/api/provider-patients/route";function k(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:D})}},8667:(e,r,t)=>{t.d(r,{Eu:()=>s});let a={Eyebrows:"forehead",Eyes:"eyes",Cheeks:"cheeks",Nose:"nose",Lips:"lips","Face and Neck Aging":"skin","Jawline/chin":"jawline","Face and neck aging":"skin",Jawline:"jawline",Chin:"jawline",Neck:"jawline",Forehead:"forehead",Skin:"skin","Skin tone":"skin",Ears:"ears","Sides of face":"cheeks","Marionette lines":"skin","Acne scars on back and lower side of thighs":"skin","Face acne, scarring":"skin","Improve scars":"skin",Idk:"other","I'm not sure":"other",any:"other","While face":"other","Smile lines?":"skin","My cheeks are sagging, the older I get.":"cheeks"};function s(e){return Array.isArray(e)?e.map(e=>a[e]||"other"):[]}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[271,107],()=>t(2811));module.exports=a})();