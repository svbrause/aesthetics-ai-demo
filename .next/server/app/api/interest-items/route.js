"use strict";(()=>{var e={};e.id=216,e.ids=[216],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6136:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>I,originalPathname:()=>g,patchFetch:()=>E,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>A,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>h});var a={};r.r(a),r.d(a,{DELETE:()=>c,GET:()=>l,POST:()=>u,dynamic:()=>d});var s=r(884),i=r(6132),n=r(1040),o=r(5798);let d="force-dynamic";async function l(e){try{let{searchParams:t}=new URL(e.url),r=t.get("patientId");if(!r)return o.Z.json({error:"Patient ID is required"},{status:400});let a=process.env.AIRTABLE_API_KEY;if(!a)return o.Z.json({error:"Airtable API key not configured"},{status:500});let s=await fetch(`https://api.airtable.com/v0/appXblSpAMBQskgzB/Interest%20Items?filterByFormula=FIND(%27${r}%27%2C%20%7BPatients%7D)&maxRecords=100`,{headers:{Authorization:`Bearer ${a}`}}),i=[];if(s.ok){let e=await s.json();i=e.records.map(e=>({id:e.id,name:e.fields["Interest Item Names"]||"Unknown Item",severity:"moderate",score:75,area:"General",notes:"",dateAdded:e.fields.Created||new Date().toISOString(),status:"Active",airtableRecordId:e.id}))}if(0===i.length){let e=await fetch(`https://api.airtable.com/v0/appXblSpAMBQskgzB/Patients?filterByFormula=%7BRECORD%20ID%7D%3D%27${r}%27&maxRecords=1`,{headers:{Authorization:`Bearer ${a}`}});if(e.ok){let t=await e.json();if(t.records.length>0){let e=t.records[0],a=e.fields["Issues String (from Patient-Issue/Suggestion Mapping) (from Interest Items)"]||"";if(a&&a.trim()){let e=a.split(",").map(e=>e.trim()).filter(Boolean);i=e.map((e,t)=>({id:`patient-${r}-${t}`,name:e,severity:"moderate",score:75,area:"General",notes:"",dateAdded:new Date().toISOString(),status:"Active",airtableRecordId:null}))}}}}return o.Z.json({records:i,total:i.length,patientId:r})}catch(e){return console.error("Error fetching interest items:",e),o.Z.json({error:"Failed to fetch interest items",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function u(e){try{let t=await e.json(),{patientId:r,findingName:a,severity:s,score:i,area:n,notes:d}=t;if(!r||!a)return o.Z.json({error:"Patient ID and finding name are required"},{status:400});let l=process.env.AIRTABLE_API_KEY;if(!l)return o.Z.json({error:"Airtable API key not configured"},{status:500});let u=await fetch("https://api.airtable.com/v0/appXblSpAMBQskgzB/Interest%20Items",{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({fields:{"Patient ID":r,"Finding Name":a,Severity:s||"moderate",Score:i||0,Area:n||"General",Notes:d||"","Date Added":new Date().toISOString(),Status:"Active"}})});if(!u.ok){let e=await u.text();return o.Z.json({error:`Airtable API error: ${u.status}`,details:e},{status:u.status})}let c=await u.json();return o.Z.json(c)}catch(e){return console.error("Error creating interest item:",e),o.Z.json({error:"Failed to create interest item",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function c(e){try{let{searchParams:t}=new URL(e.url),r=t.get("recordId");if(!r)return o.Z.json({error:"Record ID is required"},{status:400});let a=process.env.AIRTABLE_API_KEY;if(!a)return o.Z.json({error:"Airtable API key not configured"},{status:500});let s=await fetch(`https://api.airtable.com/v0/appXblSpAMBQskgzB/Interest%20Items/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}});if(!s.ok){let e=await s.text();return o.Z.json({error:`Airtable API error: ${s.status}`,details:e},{status:s.status})}return o.Z.json({success:!0})}catch(e){return console.error("Error deleting interest item:",e),o.Z.json({error:"Failed to delete interest item",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/interest-items/route",pathname:"/api/interest-items",filename:"route",bundlePath:"app/api/interest-items/route"},resolvedPagePath:"/Users/sambrause/Downloads/aesthetics-ai-demo REVERTED/src/app/api/interest-items/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:A,headerHooks:I,staticGenerationBailout:h}=p,g="/api/interest-items/route";function E(){return(0,n.patchFetch)({serverHooks:A,staticGenerationAsyncStorage:f})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[271,107],()=>r(6136));module.exports=a})();