"use strict";(()=>{var e={};e.id=832,e.ids=[832],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8991:(e,a,t)=>{t.r(a),t.d(a,{headerHooks:()=>y,originalPathname:()=>k,patchFetch:()=>P,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>A});var r={};t.r(r),t.d(r,{POST:()=>c,dynamic:()=>d});var i=t(884),o=t(6132),s=t(1040),n=t(5798),l=t(5131);let d="force-dynamic";async function c(e){try{let{airtableRecordId:a,frontPhotoBase64:t,sidePhotoBase64:r,patientName:i}=await e.json();if(!a||!t||!r)return n.Z.json({error:"Missing required fields: airtableRecordId, frontPhotoBase64, sidePhotoBase64"},{status:400});let o=process.env.AIRTABLE_API_KEY;if(!o)return n.Z.json({error:"Airtable API key not configured"},{status:500});let[s,l]=await Promise.all([fetch(`https://api.airtable.com/v0/appXblSpAMBQskgzB/Patients/${a}`,{headers:{Authorization:`Bearer ${o}`}}),u(t,r)]);if(!s.ok){let e=await s.text();return n.Z.json({error:`Airtable API error: ${s.status}`,details:e},{status:s.status})}let d=await s.json(),c=d.fields,p=c["Front Photo"]?.[0]?.url||null,m=c["Side Photo"]?.[0]?.url||null,h=c["Name (from All Issues) (from Analyses)"]||[],f=Array.isArray(h)?h:[],g=f.filter(e=>!e.includes("[DEPRECATED]")).map(e=>e.trim()).filter(e=>["Forehead Wrinkles","Glabella Wrinkles","Dark Spots","Red Spots","Marionette Lines","Temporal Hollow","Brow Asymmetry","Crooked Nose","Dorsal Hump","Over-Rotated","Nasal Tip Too Wide","Thin Lips","Lacking Philtral Column","Long Philtral Column","Dry Lips","Lip Thinning When Smiling","Retruded Chin"].includes(e)),y={id:"1005",name:i||c.Name||"Camille Fassett",age:c.Age||35,email:c.Email||"camille.fassett@email.com",phone:c.Phone||"(555) 234-5678",lastVisit:new Date().toISOString().split("T")[0],score:l.overallScore,findings:g.length>0?g:l.issues.map(e=>e.name),frontImage:p||"/Camille Fassett Front.png",sideImage:m||"/Camille Fassett Side.png",scanDate:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),airtableRecordId:a,analysisDetails:{issues:l.issues,areas:l.areas,recommendations:l.recommendations},uploadedPhotos:{front:t,side:r}};return n.Z.json({success:!0,patient:y,analysisResult:l})}catch(e){return console.error("Error in quick patient creation:",e),n.Z.json({error:"Failed to create patient record",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function u(e,a){try{let t=p(e,"front-photo.jpg"),r=p(a,"side-photo.jpg"),i=await (0,l.e)(t,r);return i.analysis}catch(e){return console.error("Error analyzing photos:",e),{issues:[{name:"Forehead Wrinkles",severity:"moderate",confidence:75,description:"Light to moderate forehead lines",area:"Forehead",gradeLetter:"B"},{name:"Nasolabial Folds",severity:"mild",confidence:68,description:"Subtle nasolabial lines",area:"Mid Face",gradeLetter:"B+"}],overallScore:78,recommendations:["Consider Botox for forehead lines","Dermal fillers for nasolabial folds"],areas:{Forehead:[{name:"Forehead Wrinkles",severity:"moderate",confidence:75,description:"Light to moderate forehead lines",area:"Forehead",gradeLetter:"B"}],"Mid Face":[{name:"Nasolabial Folds",severity:"mild",confidence:68,description:"Subtle nasolabial lines",area:"Mid Face",gradeLetter:"B+"}]}}}}function p(e,a){let t=e.split(","),r=t[0].match(/:(.*?);/)?.[1]||"image/jpeg",i=atob(t[1]),o=i.length,s=new Uint8Array(o);for(;o--;)s[o]=i.charCodeAt(o);return new File([s],a,{type:r})}let m=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/quick-patient-create/route",pathname:"/api/quick-patient-create",filename:"route",bundlePath:"app/api/quick-patient-create/route"},resolvedPagePath:"/Users/sambrause/Downloads/aesthetics-ai-demo REVERTED/src/app/api/quick-patient-create/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:h,staticGenerationAsyncStorage:f,serverHooks:g,headerHooks:y,staticGenerationBailout:A}=m,k="/api/quick-patient-create/route";function P(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[271,107,131],()=>t(8991));module.exports=r})();